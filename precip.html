<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="./css/normalize.css">
    <link rel="stylesheet" href="./css/styles.css">

    <title>Precipitación</title>

    <link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
    <link rel="manifest" href="./images/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
</head>
<body>

    <header class="header_product">
        <nav class="nav container">
            <div class="nav_logo">
                <img src="./images/logo_UCG.gif" alt="logo_UCG" class="nav_logo_img_product1">
            </div>
            
            <h1 class="header_title_product">VALENSAT</h1>
            
            <ul class="idiomas">
                <li class="idiomas_items">
                    <a href="#" class="idiomas_item">ES</a>
                </li>
                <li class="idiomas_items">
                    <a href="#" class="idiomas_item">EN</a>
                </li>
                <li class="idiomas_items">
                    <a href="#" class="idiomas_item">VAL</a>
                </li>
            </ul>

            <div class="nav_logo">
                <img src="./images/logo_uv.jpg" alt="logo_UV" class="nav_logo_img_product2">
            </div>
        </nav>
    </header>

    <main>

        <section class="menu">
            <section class="menu__container">
                <ul class="menu__links">
                    <li class="menu__item">
                        <a href="./index.html" class="menu__link">Inicio</a>
                    </li>
   
                    <li class="menu__item menu__item--show">
                        <a href="#" class="menu__link menu__item--show">Temperatura <img src="./images/arrow_down.svg" alt="down arrow" class="menu__arrow"></a>
    
                        <ul class="menu__nesting">
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Temperatura</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">LST</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Heladas</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">UHI</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">HVI</a>
                            </li>
                        </ul>
                    </li>
    
                    <li class="menu__item menu__item--show">
                        <a href="#" class="menu__link">Incendios <img src="./images/arrow_down.svg" alt="down arrow" class="menu__arrow"></a>
    
                        <ul class="menu__nesting">
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">NBR</a>
                            </li>
                            <li class="menu__inside">
                                <a href="./areaQuemada.html" class="menu__link menu__link--inside">Área quemada</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Mapas de riesgo</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Severidad</a>
                            </li>
                        </ul>
                    </li>

                    <li class="menu__item menu__item--show">
                        <a href="#" class="menu__link">Vegetación <img src="./images/arrow_down.svg" alt="down arrow" class="menu__arrow"></a>
    
                        <ul class="menu__nesting">
                            <li class="menu__inside">
                                <a href="./ndvi.html" class="menu__link menu__link--inside">Índices de vegetación</a>
                            </li>
                        </ul>
                    </li>

                    <li class="menu__item menu__item--show">
                        <a href="#" class="menu__link">Agua <img src="./images/arrow_down.svg" alt="down arrow" class="menu__arrow"></a>
    
                        <ul class="menu__nesting">
                            <li class="menu__inside">
                                <a href="./calidad.html" class="menu__link menu__link--inside">Calidad del agua</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Índices</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Humedad Relativa</a>
                            </li>
                            <li class="menu__inside">
                                <a href="./precip.html" class="menu__link menu__link--inside">Precipitación</a>
                            </li>
                        </ul>
                    </li>

                    <li class="menu__item menu__item--show">
                        <a href="#" class="menu__link">Cobertura del suelo <img src="./images/arrow_down.svg" alt="down arrow" class="menu__arrow"></a>
    
                        <ul class="menu__nesting">
                            <li class="menu__inside">
                                <a href="./landcover.html" class="menu__link menu__link--inside">Land Cover</a>
                            </li>
                            <li class="menu__inside">
                                <a href="#" class="menu__link menu__link--inside">Evolución temporal</a>
                            </li>
                        </ul>
                    </li>
    
                    <li class="menu__item">
                        <a href="./por_zona.html" class="menu__link">Por zona</a>
                    </li>

                    <li class="menu__item">
                        <a href="#" class="menu__link">Acerca de</a>
                    </li>
                </ul>

                <div class="menu__hamburguer">
                    <h2 class="title_hamburguer">PRODUCTOS DISPONIBLES</h2>
                    <img src="./images/mouse.svg" alt="menu" class="menu__img">
                </div>
            </section>
        </section>

        <section class="container about">
            <h2 class="subtitle">Histórico datos climatólogicos</h2>
            <p class="about_paragraph">Lorem ipsum dolor sit amet consectetur adipisicing elit. Beatae voluptates exercitationem, voluptatem tempora consequatur in, accusantium assumenda doloribus necessitatibus, eum aperiam illum porro pariatur? Magnam facere possimus praesentium libero rerum.
            Repellendus ipsum commodi totam. Ut a cumque, saepe deserunt, mollitia distinctio architecto omnis enim dolorum id, ex sed eaque numquam! Explicabo quae dolore nemo, porro esse illo sapiente quas soluta.
            Ullam, reprehenderit. Ipsum, debitis blanditiis at et cum possimus molestiae. Atque, a! Iusto incidunt deserunt excepturi ab. Ducimus cum quisquam itaque quia provident ab! Quibusdam nemo fuga rerum doloribus itaque!
            Velit officia delectus laborum asperiores quam pariatur eum rem optio consectetur natus facere ipsam eius, sunt voluptatibus tempora harum esse distinctio? Maiores iure explicabo beatae iusto dicta consequatur, modi earum.</p>
        </section>
        
        <div class="container_appmap">
            <div class="img_marco">
                <img src="./images/graf1.jpg" alt="Histórico temperatura">
            </div>
            <div class="img_marco">
                <img src="./images/graf2.jpg" alt="Histórico precipitación">
            </div>
        </div>

        <div class="container_avamet">
            <div class="table">
                <h2 class="subtitle">Datos AVAMET</h2>
                <div id="table_avamet"></div>
            </div>
        </div>
       
        <div class="container">
            <div class="table_title">
                <h2 class="subtitle">Temperatura de las últimas 24h - AEMET</h2>
            </div>
            <canvas id="temp_graph"></canvas>
        </div>




    </main>


    <footer class="footer">
        <section class="footer_container container">
            <nav class="nav nav--footer">
                <h2 class="footer_title">VALENSAT</h2>
            </nav>
        </section>
    </footer>

    


    <script src="./js/app.js"></script>
    <script src="./js/chart.js"></script>

    <script>
        // Using XMLHttpRequest().
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == XMLHttpRequest.DONE) {
                if (xmlhttp.status == 200) {
                    var table_container = document.getElementById('table_avamet');
                    csv_string_to_table(xmlhttp.responseText, table_container);
                }
            }
        };
        xmlhttp.open("GET", "./data/AVAMET/13h_avamet.csv", true);
        xmlhttp.send();
        function csv_string_to_table(csv_string, element_to_insert_table) {
            var rows = csv_string.trim().split(/\r?\n|\r/); // Regex to split/separate the CSV rows
            var table = '';
            var table_rows = '';
            var table_header = '';
            rows.forEach(function(row, row_index) {
                var table_columns = '';
                var columns = row.split(','); // split/separate the columns in a row
                columns.forEach(function(column, column_index) {
                    table_columns += row_index == 0 ? '<th class="th_avamet">' + column + '</th>' : '<td class="td_avamet">' + column + '</td>';
                });
                if (row_index == 0) {
                    table_header += '<tr class="tr_avamet">' + table_columns + '</tr>';
                } else {
                    table_rows += '<tr class="tr_avamet">' + table_columns + '</tr>';
                }
            });
            table += '<table class="table">';
                table += '<thead class="table_avamet--header">';
                    table += table_header;
                table += '</thead>';
                table += '<tbody>';
                    table += table_rows;
                table += '</tbody>';
            table += '</table>';
            element_to_insert_table.innerHTML += table;
        }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.2/d3.min.js" integrity="sha512-oKI0pS1ut+mxQZdqnD3w9fqArLyILRsT3Dx0B+8RVEXzEk3aNK3J3pWlaGJ8MtTs1oiwyXDAH6hG6jy1sY0YqA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>
    <script>
        const chartData = './data/AVAMET/temp_aemet.csv'
        // parse the file from CSV to JSON
        d3.csv(chartData).then(function(datapoints) {
            const HORA = [];
            const TEMPERATURA = [];
            const TEMPERATURA_MAXIMA = [];
            const TEMPERATURA_MINIMA = [];

            for (i = 0; i < datapoints.length; i++) {
                HORA.push(datapoints[i].HORA)
                TEMPERATURA.push(datapoints[i].TEMPERATURA)
                TEMPERATURA_MAXIMA.push(datapoints[i].TEMPERATURA_MAXIMA)
                TEMPERATURA_MINIMA.push(datapoints[i].TEMPERATURA_MINIMA)
            }
  
        // setup 
        const data = {
            labels: HORA,
            datasets: [{
            label: 'Temperatura media (ºC)',
            data: TEMPERATURA,
            backgroundColor: '#fff',
            borderColor: '#806491',
            borderWidth: 2
            },
            {
            label: 'Temperatura máxima (ºC)',
            data: TEMPERATURA_MAXIMA,
            backgroundColor: '#fff',
            borderColor: ['rgba(227, 73, 73, 0.5)'],
            borderWidth: 1
            },
            {
            label: 'Temperatura mínima (ºC)',
            data: TEMPERATURA_MINIMA,
            backgroundColor: '#fff',
            borderColor: ['rgba(47, 112, 175, 0.5)'],
            borderWidth: 1
            }
        ]
        };

        // config 
        const config = {
            type: 'line',
            data,
            options: {
            scales: {
                y: {
                beginAtZero: true,
                }
            }
            }
        };
    
        // render init block
        const myChart = new Chart(
            document.getElementById('temp_graph'),
            config
        );
        })
    </script>

</body>
</html>